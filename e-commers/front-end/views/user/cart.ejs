
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="background-color: rgba(128, 128, 128, 0.515);">

  <div>
    <%- include('../partials/navbar') %>
  </div>

  <div>
    <div class="wallpaper-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden;">
      <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; height: 90%;">
        <img src="/img/wallpaper.png" alt="Background Wallpaper" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px; z-index: -1; opacity: 0.7;">
        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: border-box(rgba(128, 128, 128, 0.686), rgba(79, 74, 74, 0.6)); border-radius: 10px;"></div>
      </div>
    </div>
  </div>

  <!-- CART -->
  <div class="container mt-5">
    <div class="card" style="background-color: rgb(79, 74, 74); color: red; border: 2px solid black; border-radius: 15px; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 2px 2px 5px rgb(75, 75, 75);">
      <div class="card-header">
        <h1 class="text-center">Your Shopping Cart</h1>
      </div>
      
      <div class="card-body">
        <% if (typeof error !== 'undefined' && error) { %>
          <div class="alert alert-danger"><%= error %></div>
        <% } %>
        
        <% if (cart && cart.items && cart.items.length > 0) { %>
          <div class="table-responsive">
            <table class="table table-bordered" style="color: red; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
              <thead style="color: red; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
                <tr style="color: red; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
                  <th>Product</th>
                  <th>Price</th>
                  <th>Quantity</th>
                  <th>Total</th>
                  <th>Actions</th>
                </tr>
                <script>
                  document.addEventListener('DOMContentLoaded', function() {
                  // Style for all table headers
                  const tableHeaders = document.querySelectorAll('th');
                  tableHeaders.forEach(th => {
                    th.style.backgroundColor = 'rgba(0, 0, 0, 0.4)';
                    th.style.color = 'red';
                    th.style.fontWeight = 'bold';
                    th.style.padding = '12px';
                    th.style.borderBottom = '2px solid #990000';
                  });
                  
                  // Style for all table cells
                  const tableCells = document.querySelectorAll('td');
                  tableCells.forEach(td => {
                    td.style.padding = '10px';
                    td.style.borderBottom = '1px solid rgba(255, 0, 0, 0.3)';
                    td.style.verticalAlign = 'middle';
                  });
                  
                  // Style for table rows with hover effect
                  const tableRows = document.querySelectorAll('tbody tr');
                  tableRows.forEach(tr => {
                    tr.style.transition = 'background-color 0.3s';
                    
                    tr.addEventListener('mouseover', function() {
                    this.style.backgroundColor = 'rgba(80, 0, 0, 0.3)';
                    });
                    
                    tr.addEventListener('mouseout', function() {
                    this.style.backgroundColor = 'transparent';
                    });
                  });
                  });


                </script>
              </thead>
              <tbody style="color: red; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
                <% cart.items.forEach(item => { %>
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <% if (item.imgUrl) { %>
                          <img src="<%= item.imgUrl %>" alt="<%= item.name %>" style="width: 50px; height: 50px; object-fit: contain; margin-right: 10px;">
                        <% } %>
                        <div>
                          <h5 class="mb-0"><%= item.name %></h5>
                          <small><%= item.description ? item.description.substring(0, 50) + '...' : '' %></small>
                        </div>
                      </div>
                    </td>
                    <td>$<%= item.price.toFixed(2) %></td>
                    <td>
                      <div class="d-flex align-items-center">
                        <form action="/cart/update" method="POST" class="me-2">
                          <input type="hidden" name="cartItemId" value="<%= item.id %>">
                          <input type="hidden" name="action" value="decrease">
                          <button type="submit" class="btn btn-sm btn-danger">-</button>
                        </form>
                        
                        <span><%= item.quantity %></span>
                        
                        <form action="/cart/update" method="POST" class="ms-2">
                          <input type="hidden" name="cartItemId" value="<%= item.id %>">
                          <input type="hidden" name="action" value="increase">
                          <button type="submit" class="btn btn-sm btn-danger">+</button>
                        </form>
                      </div>
                    </td>
                    <td>$<%= item.total.toFixed(2) %></td>
                    <td>
                      <form action="/cart/remove" method="POST">
                        <input type="hidden" name="cartItemId" value="<%= item.id %>">
                        <button type="submit" class="btn btn-sm btn-danger">Remove</button>
                      </form>
                    </td>
                  </tr>
                <% }) %>

                <script>
                  document.addEventListener('DOMContentLoaded', function() {
                  // Style for all table headers
                  const tableHeaders = document.querySelectorAll('th');
                  tableHeaders.forEach(th => {
                    th.style.backgroundColor = 'rgba(0, 0, 0, 0.4)';
                    th.style.color = 'red';
                    th.style.fontWeight = 'bold';
                    th.style.padding = '12px';
                    th.style.borderBottom = '2px solid #990000';
                  });
                  
                  // Style for all table cells
                  const tableCells = document.querySelectorAll('td');
                  tableCells.forEach(td => {
                    td.style.padding = '10px';
                    td.style.borderBottom = '1px solid rgba(255, 0, 0, 0.3)';
                    td.style.verticalAlign = 'middle';
                  });
                  
                  // Style for table rows with hover effect
                  const tableRows = document.querySelectorAll('tbody tr');
                  tableRows.forEach(tr => {
                    tr.style.transition = 'background-color 0.3s';
                    
                    tr.addEventListener('mouseover', function() {
                    this.style.backgroundColor = 'rgba(80, 0, 0, 0.3)';
                    });
                    
                    tr.addEventListener('mouseout', function() {
                    this.style.backgroundColor = 'transparent';
                    });
                  });
                  });
                </script>


              </tbody>
              <tfoot>
                <tr>
                  <td colspan="3" class="text-end"><strong>Total:</strong></td>
                  <td colspan="2"><strong>$<%= cart.totalPrice.toFixed(2) %></strong></td>
                </tr>
              </tfoot>
            </table>
          </div>
          
          <div class="d-flex justify-content-between mt-4">
            <a href="/products" class="btn btn-danger" style="color: red; border: 1px solid black; font-weight: Bold; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
              Continue Shopping
            </a>
            
            <a href="/checkout" class="btn btn-danger" style="color: red; border: 1px solid black; font-weight: Bold; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
              Proceed to Checkout
            </a>
          </div>
        <% } else { %>
          <div class="text-center py-5">
            <h3>Your cart is empty</h3>
            <p>Looks like you haven't added any products to your cart yet.</p>
            <a href="/products" class="btn btn-danger mt-3" style="color: red; border: 1px solid black; font-weight: Bold; text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;">
              Browse Products
            </a>
          </div>
        <% } %>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>